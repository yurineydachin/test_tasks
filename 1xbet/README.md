Асинхронный загрузчик страниц для лайв сканера 1хбет

Потребность в таком загрузчике возникла из-за тормозов некоторых запросов. В часы пик бывают ситуации, когда параллельная загрузка страниц, напирмер, через мультикурл тормозит из-за ожидания ответа самого долгого запроса. И вообще хотелось уйти от ожидания ответа на запросы, а иметь уже загруженные страницы с приемлемой актуальностью к моменту начала парсинга.

Принцип работы:

1. Пхп (или любой другой) сканер загружает один процесс питон загрузчика, тот в свою очередь сохраняет данные в хранилище (мемкеш или редис), пхп загружает данные из хранилища и узнает сколько процессов питона ему нужно.
2. Далее сканер запускает все необходимые процессы питона и получает актуальные загруженные данные из хранилища, обрабатывает их.
3. Питон создает поток для каждого загружаемого урла, по ходу работы потоки могут добавляться и убираться. Главная задача управляющего сканера создать необходимое число питон процессов, чтобы у каждого процесса было по возможности не более 100 потоков, иначе потребление процессора будет больше допустимого и питон не будет делать ничего полезного, а будет занят сам собой.

Здесь реализован самый простой способ балансировки нагрузки - по кратности номера матча. Процесс питона с номером 1 будет брать только матчи, у которых остаток от деления, например, на 20 == 1. Поскольку на 1хбете встречаются только нечетные номера матчей, то нет необходимости создавать четные процессы питона.
